{% macro agent_visualization(run_path, title="Agent Visualization", left_width=350, right_width=220) %}
<div class="bg-white shadow rounded-lg p-4 mt-6">
    <h2 class="text-xl font-bold mb-3">{{ title }}</h2>
    
    <div class="flex items-stretch justify-between relative">
        <button id="prevRun_{{ run_path }}" class="text-6xl font-bold text-[#da7756] px-4 hover:bg-gray-100 flex items-center">&lt;</button>
        
        <div class="flex-1">
            <div class="flex flex-col lg:flex-row justify-center items-center gap-4 lg:gap-0 max-w-[800px] mx-auto">
                <div class="relative w-fit shrink-0">
                    <div class="p-[4%] rounded-xl" style="background-color: #da7756;">
                        <div class="bg-white">
                            <img id="mainFrame_{{ run_path }}" class="w-full h-full object-contain aspect-square" 
                                 style="max-width: {{ left_width }}px" src="" alt="Main View">
                        </div>
                    </div>
                </div>

                <div class="hidden lg:flex self-center h-2.5 connecting-line shrink-0" 
                     style="background-color: #da7756; width: clamp(2rem, 5vw, 4rem); margin: 0 -2px;">
                </div>

                <div class="relative w-fit shrink-0">
                    <div class="p-[4%] rounded-xl" style="background-color: #da7756;">
                        <div class="bg-white">
                            <img id="memoryHeatmap_{{ run_path }}" class="w-full h-full object-contain aspect-square" 
                                 style="max-width: {{ right_width }}px" src="" alt="Memory Heatmap">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <button id="nextRun_{{ run_path }}" class="text-6xl font-bold text-[#da7756] px-4 hover:bg-gray-100 flex items-center">&gt;</button>
    </div>

    <div class="mt-4 max-w-xl mx-auto text-center">
        <div id="runInfo_{{ run_path }}" class="text-sm text-gray-600 mb-2"></div>
        <input 
            type="range" 
            id="frameSlider_{{ run_path }}" 
            class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-[#da7756]"
            min="0" 
            value="0"
        >
        <div class="text-center mt-2">
            Frame: <span id="frameNumber_{{ run_path }}">0</span> / <span id="maxFrame_{{ run_path }}">0</span>
        </div>
    </div>
</div>
{% endmacro %}
